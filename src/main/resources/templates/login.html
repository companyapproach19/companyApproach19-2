<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
 
<!DOCTYPE html>
<html>
<head>
<script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>


<!-- CSSSS -->
<link href="../public/stylesheets/Login.css" rel="stylesheet" id="bootstrap-css">
<!-- CSSSSS -->

<!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

<title>Login</title>
   
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
 
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">-->

<!-- Import jquery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
 
</head>
<body>
<div class="main">
    
    
<div class="container">
<center>
<div class="middle">
      <div id="login">

        <form action="javascript:void(0);" method="get">

          <fieldset class="clearfix">

            <p ><span class="fa fa-user"></span><input type="text"  Placeholder="Username" id="username" required></p> <!-- JS because of IE support; better: placeholder="Username" -->
            <p><span class="fa fa-lock"></span><input type="password"  Placeholder="Password" id="password" required></p> <!-- JS because of IE support; better: placeholder="Password" -->
            

             <div>                               
               <span style="width:50%; text-align:right;  display: inline-block;"><input type="submit" onClick="getDataLogin()" value="Sign In"></span>
             </div>

          </fieldset>
<div class="clearfix"></div>
        </form>

        <div class="clearfix"></div>

      </div> <!-- end login -->
      <div class="logo">
      <img src="https://images.vexels.com/media/users/3/144118/isolated/lists/31093a4558d1aa47a6fcec2a174f2754-signo-de-cerveza-de-neon.png">
          
          <div class="clearfix"></div>
      </div>
      
      </div>
</center>
    </div>



<script>
var email;
var password;

function getDataLogin(){
	email = $("#username").val();
	password = $("#password").val();
	var log = {"usuario":email,"pwd":password};
	console.log(log);
	logIn(email, password);
}
function logIn(email,password){
  $.getJSON("loginUser?usuario="+email+"&pwd="+password, function(data) {
    alert("BIEN. FUNCIONO GET JSON");
    if(data==null){
		console.log("soy null");
		alert("Identification error. Please check that the email and password are correct.")
    }else{
    	localStorage.setItem("currentUser", JSON.stringify(data));
        console.log("correct!");
        location.href = data.redirect;
    } 
						 
 });	
};
	//alert("MAL. NO FUNCIONO GET JSON");
	
	//TRAMPA


var usuarios = new Array ( '{ "nombre":"Agricultor","mail":"agricultor@email.com", "tipoActor":"Agricultor" }',
	'{ "nombre":"Cooperativa","mail":"cooperativa@email.com", "tipoActor":"Cooperativa" }',
	'{ "nombre":"Transportista","mail":"transportista@email.com", "tipoActor":"Transportista" }',
	'{ "nombre":"Fábrica","mail":"fabrica@email.com", "tipoActor":"Fábrica" }',
	'{ "nombre":"Retailer","mail":"retailer@email.com", "tipoActor":"Retailer" }' );


	for (var i = 0; i < usuarios.length; i++) {
		var actor = JSON.parse( usuarios[i] );
								  
		if (email == actor.nombre && password == "password" ) { 
		  vistaPrincipal(actor.tipoActor)
		  break;
		}
		else {
	      //window.location.replace("LoginError.html");
		}
    }
	  
//-----------------------------TRAMPA-----------------------------
  
  
function vistaPrincipal(tipoActor) {
      
      switch (tipoActor) {
      case "Agricultor" :
	  window.location.replace("agricultoresInicio.html");
	  break;
      case "Cooperativa":
	  window.location.replace("cooperativaInicio.html");
	  break;
      case "Transportista":
	  window.location.replace("Transportista.html");
	  break;
      case "Fábrica":
	  window.location.replace("Fabrica.html");
	  break;
      case "Retailer":
	  window.location.replace("tiendaInicio.html");
	  break;
      default:
	  window.location.replace("LoginError.html");
      }
  }
  
  
 
 
 
 </script>

</div>
</body>
</html>
